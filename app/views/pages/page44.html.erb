<script type="text/javascript">
	var weapon = "";
	var s1 = 15;
	var s2 = 25;
	var s3 = 45;
	var s4 = 50;
	
	var dam1 = 75;
	var dam1 = 1;
	var damage;
	var health = 750;
	var phealth = 500;
	var enemyDamage = 0;
	var hpack = 2;	
	var dpack = 1;	
	var defense = 0;
	var first = 1;

function load(){
	document.getElementById("buttonh").disabled = true;
	document.getElementById("buttond").disabled = true;
}

function getEnemyDamage()
{

 	if((health == 750) || (health >= 650))
		return s1;

	else if((health >= 500) || (health >= 450))
		return s2;

	else if((health >= 100) ||(health >= 50))
		return s3;

	else{
		return Math.ceil(Math.random() * 30) + 1;
	}

}


function healPlayer() {
	enemyDamage = getEnemyDamage();
	if(phealth < 450 && hpack > 0){
		document.getElementById("message1").innerHTML = "<p> <b>Player Healed!</b> The player gain <b>" + s4 + "</b> health points.</p>";
		phealth = phealth + s4;
		hpack = hpack - 1;
		document.getElementById("hp").innerHTML = phealth;
		document.getElementById("potions").innerHTML = hpack;
		}
	else if(hpack == 0){
		document.getElementById("message1").innerHTML = "<p> No potions left</p>";
		}
	else{
		document.getElementById("message1").innerHTML = "<p> Player still have health greater than 50.</p>";
		}
		
	if(phealth == 500)
			document.getElementById("playerHealth").className = "progress-bar progress-bar-danger sword-green sword-100";
		
		if(phealth >= 450){
			document.getElementById("playerHealth").className = "progress-bar sword-green sword-90";
		}
		else if(phealth >= 400)
			document.getElementById("playerHealth").className = "progress-bar sword-green sword-80";
		else if(phealth >= 350)
			document.getElementById("playerHealth").className = "progress-bar sword-green sword-70";
		else if(phealth >= 300)
			document.getElementById("playerHealth").className = "progress-bar sword-orange sword-60";
		else if(phealth >= 250)
			document.getElementById("playerHealth").className = "progress-bar sword-orange sword-50";
		else if(phealth >= 200)
			document.getElementById("playerHealth").className = "progress-bar sword-orange sword-40";
		else if(phealth >= 150)
			document.getElementById("playerHealth").className = "progress-bar sword-red sword-30";
		else if(phealth >= 100)
			document.getElementById("playerHealth").className = "progress-bar sword-red sword-20";
		else if(phealth >= 50)
			document.getElementById("playerHealth").className = "progress-bar sword-red sword-10";
}


function def() {
	defense = 1;
	dpack= dpack - 1;
	document.getElementById("defcount").innerHTML = dpack;
	}



function playerDamage()
{
	setTimeout(function()
	{
		enemyDamage = getEnemyDamage();
		if(defense == 0){
			if(enemyDamage == 10)
				document.getElementById("message1").innerHTML = "<p> <b>SPECIAL ATTACK!</b> The player took <b>" + enemyDamage + "</b> damage from the enemy.</p>";

			else if(enemyDamage == 15)
				document.getElementById("message1").innerHTML = "<p> <b>SPECIAL ATTACK!</b> The player took <b>" + enemyDamage + "</b> damage from the enemy.</p>";
			else if(enemyDamage == 20)
				document.getElementById("message1").innerHTML = "<p> <b>SPECIAL ATTACK!</b> The player took <b>" + enemyDamage + "</b> damage from the enemy.</p>";
			else
				document.getElementById("message1").innerHTML = "<p> The player took " + enemyDamage + " damage from the enemy.</p>";

		//health = 100;
		damage = 10;
		}
		else{
			document.getElementById("message1").innerHTML = "<p> Player deflected the damage.</p>";
			defense = 0;
		}
		document.getElementById("hp").innerHTML = phealth;

		//alert("Swordman " + damage);
		if(phealth == 500)
			document.getElementById("playerHealth").className = "progress-bar progress-bar-danger sword-green sword-100";
		
		if(phealth >= 450){
			document.getElementById("playerHealth").className = "progress-bar sword-green sword-90";
		}
		else if(phealth >= 400)
			document.getElementById("playerHealth").className = "progress-bar sword-green sword-80";
		else if(phealth >= 350)
			document.getElementById("playerHealth").className = "progress-bar sword-green sword-70";
		else if(phealth >= 300)
			document.getElementById("playerHealth").className = "progress-bar sword-orange sword-60";
		else if(phealth >= 250)
			document.getElementById("playerHealth").className = "progress-bar sword-orange sword-50";
		else if(phealth >= 200)
			document.getElementById("playerHealth").className = "progress-bar sword-orange sword-40";
		else if(phealth >= 150)
			document.getElementById("playerHealth").className = "progress-bar sword-red sword-30";
		else if(phealth >= 100)
			document.getElementById("playerHealth").className = "progress-bar sword-red sword-20";
		else if(phealth >= 50)
			document.getElementById("playerHealth").className = "progress-bar sword-red sword-10";
		else if(phealth <= 0)
			window.location.href = "/defeat2";
		
}, 500); 

}

function attack(){
			
	document.getElementById("buttonh").disabled = false;
	document.getElementById("buttond").disabled = false;
	if(dpack == 0){
		document.getElementById("buttond").disabled = true;
		document.getElementById("buttond").innerText = "none left";
		}
		
	if(hpack == 0){
		document.getElementById("buttonh").disabled = true;
		document.getElementById("buttonh").innerText = "none left";
		}
		
	enemyDamage = getEnemyDamage();
	if(defense == 0){
		if(phealth <= 0)
			window.location.href = "/defeat";

		else if((health == 700) || (health == 650))
			phealth -= s1;

		else if((health == 500) || (health == 450))
			phealth -= s2;

		else if((health == 100) || (health == 50))
			phealth -= s3;

		else
			phealth -= enemyDamage;
	}
	
playerDamage();
	weapon = document.getElementById("weapon_type").value;
	


	if(health == 750)
		document.getElementById("ahealth").className = "progress-bar progress-bar-danger sword-green sword-100";


	if(weapon == "Sword")
	{
		document.getElementById("message").innerHTML = "<p> The player attacked dealing 5 damage to the enemy.</p>";


		damage = 5;
		health -= damage;

		document.getElementById("enemy").innerHTML = health;

		if(health >= 750)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-95";
		else if(health >= 700)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-90";
		else if(health >= 650)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-85";
		else if(health >= 600)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-80";
		else if(health >= 550)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-75";
		else if(health >= 500)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-70";
		else if(health >= 450)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-65";
		else if(health >= 400)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-60";
		else if(health >= 350)
			document.getElementById("ahealth").className = "progress-bar sword-orange sword-55";
		else if(health >= 300)
			document.getElementById("ahealth").className = "progress-bar sword-orange sword-50";
		else if(health >= 250)
			document.getElementById("ahealth").className = "progress-bar sword-orange sword-45";
		else if(health >= 200)
			document.getElementById("ahealth").className = "progress-bar sword-orange sword-40";
		else if(health >= 150)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-35";
		else if(health >= 100)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-30";
		else if(health >= 50)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-25";
		else if(health >= 30)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-20";
		else if(health >= 25)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-15";
		else if(health >= 15)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-10";
		else if(health > 5 || (health < 5 && health >0))
			document.getElementById("ahealth").className = "progress-bar sword-red sword-5";
		else if(health <= 0){
			document.getElementById("ahealth").className = "progress-bar sword-red sword-0";
			window.location.href = "/victory";
		}
	}
	else if(weapon == "Gun")
	{

		document.getElementById("message").innerHTML = "<p> The party attacked dealing 10 damage</p>";

		if(health <= 0)
		{
			window.location.href = "/victory";
		}

		//health = 100;
		damage = 30;

		//alert("Swordman " + damage);
		health -= damage;

		document.getElementById("enemy").innerHTML = health;

		if(health >= 750)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-95";
		else if(health >= 700)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-90";
		else if(health >= 650)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-85";
		else if(health >= 600)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-80";
		else if(health >= 550)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-75";
		else if(health >= 500)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-70";
		else if(health >= 450)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-65";
		else if(health >= 400)
			document.getElementById("ahealth").className = "progress-bar sword-green sword-60";
		else if(health >= 350)
			document.getElementById("ahealth").className = "progress-bar sword-orange sword-55";
		else if(health >= 300)
			document.getElementById("ahealth").className = "progress-bar sword-orange sword-50";
		else if(health >= 250)
			document.getElementById("ahealth").className = "progress-bar sword-orange sword-45";
		else if(health >= 200)
			document.getElementById("ahealth").className = "progress-bar sword-orange sword-40";
		else if(health >= 150)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-35";
		else if(health >= 100)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-30";
		else if(health >= 50)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-25";
		else if(health >= 30)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-20";
		else if(health >= 25)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-15";
		else if(health >= 15)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-10";
		else if(health >= 5)
			document.getElementById("ahealth").className = "progress-bar sword-red sword-5";
		else if(health >= 0){
			document.getElementById("ahealth").className = "progress-bar sword-red sword-0";
		
			window.location.href = "/victory";
		}
		
	
	}
	
}


</script>

<style type="text/css">
	.sword-green{
		background-color: green;
	}
	.sword-orange{
		background-color: orange;
	}
	.sword-red{
		background-color: red;
	}
	.sword-100{		
		width: 100%;
	}
	.sword-90{
		width: 90%;
	}
	.sword-80{
		width: 80%;	
	}
	.sword-70{
		width: 70%;	
	}
	.sword-60{
		width: 60%;	
	}
	.sword-50{
		width: 50%;	
	}
	.sword-40{
		width: 40%;	
	}
	.sword-30{
		width: 30%;	
	}
	.sword-20{
		width: 20%;	
	}
	.sword-10{
		width: 10%;	
	}
	.sword-0{
		width: 0%;	
	}
	.sword-5{		
		width: 5%;
	}
	.sword-15{
		width: 15%;
	}
	.sword-25{
		width: 25%;	
	}
	.sword-35{
		width: 35%;	
	}
	.sword-45{
		width: 45%;	
	}
	.sword-55{
		width: 55%;	
	}
	.sword-65{
		width: 65%;	
	}
	.sword-75{
		width: 75%;	
	}
	.sword-85{
		width: 85%;	
	}
	.sword-95{
		width: 95%;	
	}

</style>
<body onload="load();">
<div style="margin-top: 20px;" >
	<div class="container">
		<div class= "row">
			<div class="col-sm-12">
				<div class="row">
					<div class = "col-3 col-sm-3">
				    	<div style="width: 100%; height: 500px; padding: 3px; border: 3px solid gray; margin: 0;">
					    	<h5>Ex Raid</h5>
					    	<h5>Level 1</h5>`
							
								
								<%= image_tag("Power up - Medal 3.png", size: "100x100") %>
								<button id="buttonh" class="btn btn-primary" onclick = "healPlayer(); return false;">use</button>
								<p>potions left:<h5 id="potions" style="text-align:center;"> 2 </h5>
								</p> 
								
								<%= image_tag("Power up def - Medal.png", size: "100x100") %>
								<button id="buttond" class="btn btn-primary" onclick = "def(); return false;">deflect</button>
								<p>Use left:<h5 id="defcount" style="text-align:center;"> 1 </h5>
								</p> 
							
				    	
					  	</div>
					</div>
	    			<div class="col-8 col-sm-8">
	       				<div style="width: 100%; height: 500px; padding: 3px; border: 3px solid gray; margin: 0;">
	       					<div class="row">
	       						<div class="col-sm-2" style="margin: 15px;">
									<%= image_tag("Ex Raid - Combat.png", size: "120x200") %>	
								</div>
								<div class="col-sm-2" style=" margin: 15px; visibility: hidden;">
									<%= image_tag("Courageous - Combat.png", size: "120x200") %>	
								</div>
								<div class="col-sm-2" style=" margin: 15px; visibility: hidden;">
									<%= image_tag("Gunner - Combat.png", size: "120x200") %>	
								</div> 
								<div class="col-sm-2" style="margin-left: 20px;">
									<%= image_tag("Hazardous Zombie.png", size: "200x200") %>
								<div class="col-sm-2" style="margin-left: 20px;">
							</div>
						</div>
	       			</div>
			 		<div class="row">
	       				<div class="col-sm-2">
	       					<button type="button" class="btn btn-default btn-lg" style="margin-top: 5px;"> Ex Raid - 
	       						<select class = "form-control" id = "weapon_type"> <% @weapons.each do |weapon| %>
									<option value = "<%= weapon.name %>"><%= weapon.name %></option>
	     							<% end %>
	         					</select>
	                 		</button>
						</div>
						<div class="col-sm-2" style="visibility: hidden;">
	       					<button type="button" class="btn btn-default btn-lg" style="margin-top: 5px;"> Ex Raid - 
	       						<select class = "form-control" id = "weapon_type"> <% @weapons.each do |weapon| %>
									<option value = "<%= weapon.name %>"><%= weapon.name %></option>
	     							<% end %>
	         					</select>
	                 		</button>
						</div>
						<div class="col-sm-2" style="visibility: hidden;">
	       					<button type="button" class="btn btn-default btn-lg" style="margin-top: 5px;"> Ex Raid - 
	       						<select class = "form-control" id = "weapon_type"> <% @weapons.each do |weapon| %>
									<option value = "<%= weapon.name %>"><%= weapon.name %></option>
	     							<% end %>
	         					</select>
	                 		</button>
						</div>
						<div class="col-sm-2">
	       				
						</div>

						<!--progress bar with attack button-->
						<div class="col-sm-3" align="right" style="text-align: center;">
							<div class="progress">
								<div id = "ahealth" class="progress-bar sword-100" role="progressbar"><span id="enemy">750</span>/750</div>
							</div>

							
							
							<button class="btn btn-primary" onclick = "attack(); return false;">Attack</button>
	       				</div>
	       			</div>
	       			<div class="row">
	       				<div class="col-sm-10" id ="message" style="margin-left:10px; text-align: left; top: 100px;">
	       				</div>
	       				<div class="col-sm-10" id ="message1" style="margin-left:10px; text-align: left; top: 100px;">
	       				</div>
	       			</div>
	       		</div>
			</div>
			<div class= "col- 12 col-sm-11">
				<div style="width: 100%; padding: 3px; border: 3px solid gray; margin-top: 15px;">
					<div class="row">
						<div class="col-sm-2">
							<%= image_tag("Ex Raid small.png", size: "100x100") %>	
						</div>
						<div class="col-sm-2">
							<h4>HP:</h4><br>
							<button style="margin-left: 500px" id="buttonh" class="btn btn-primary" onclick = "skill1(); return false;">skill1</button>
						</div>
						<div class="col-sm-2">
							<div class="progress" style="margin-top: 10px;">
							<div class="progress-bar progress-bar-danger sword-green sword-100" id = "playerHealth" role="progressbar">
								<span id="hp">500</span>/500
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>		
</div>		
	
</body>
